<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  background:#000;
  color:white;
  font-family:sans-serif;
}

#chat{
  margin-bottom:80px;
}

.msg{
  margin:8px 0;
}

.nickname{
  color:gold;
  font-weight:bold;
  text-decoration:none;
}

input{
  padding:10px;
  margin:5px;
}
button{
  padding:10px;
  background:orange;
  border:none;
  color:black;
}
</style>
</head>
<body>

<h2>ğŸ’¬ áƒ¡áƒáƒ”áƒ áƒ—áƒ áƒ©áƒáƒ¢áƒ˜</h2>

<div id="chat"></div>

<input type="text" id="nicknameInput" placeholder="áƒœáƒ˜áƒ™áƒ˜">
<input type="text" id="messageInput" placeholder="áƒ›áƒ”áƒ¡áƒ˜áƒ¯áƒ˜">
<button onclick="sendMessage()">áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ</button>

<script>
const supabase = window.supabase.createClient(
  "https://YOUR_PROJECT.supabase.co",
  "YOUR_PUBLIC_ANON_KEY"
);

const chat = document.getElementById("chat");

async function loadMessages(){
  const { data } = await supabase
    .from("messages_v3")
    .select("*")
    .order("created_at", { ascending:true });

  chat.innerHTML = "";

  data.forEach(msg=>{
    chat.innerHTML += `
      <div class="msg">
        <a class="nickname" href="profile.html?user=${msg.nickname}">
          ${msg.nickname}
        </a>: ${msg.message}
      </div>
    `;
  });
}

async function sendMessage(){
  const nickname = document.getElementById("nicknameInput").value;
  const message = document.getElementById("messageInput").value;

  if(!nickname || !message) return;

  await supabase.from("messages_v3").insert([
    { nickname, message }
  ]);

  document.getElementById("messageInput").value="";
  loadMessages();
}

loadMessages();
</script>

</body>
</html>
