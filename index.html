<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OLD MAFIA - áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background: #000; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        
        /* áƒ¨áƒ”áƒœáƒ˜ áƒšáƒáƒ’áƒ áƒ“áƒ áƒ“áƒ˜áƒ–áƒáƒ˜áƒœáƒ˜ */
        .header-area { text-align: center; margin-bottom: 40px; }
        .logo-box { display: flex; align-items: center; gap: 10px; justify-content: center; }
        .logo-icon { font-size: 45px; }
        .logo-text { color: #ff8c00; font-size: 35px; font-weight: bold; text-transform: uppercase; }
        
        .inbox-link { color: #fff; text-decoration: none; font-size: 16px; margin: 25px 0; display: flex; align-items: center; gap: 8px; opacity: 0.8; }
        .inbox-link:hover { opacity: 1; }

        /* áƒ˜áƒœáƒáƒ£áƒ¢áƒ”áƒ‘áƒ˜ áƒ¨áƒ”áƒœáƒ˜ áƒ¤áƒáƒ¢áƒáƒ“áƒáƒœ */
        input { width: 320px; padding: 15px; margin-bottom: 12px; border-radius: 10px; border: none; background: #fff; color: #333; font-size: 16px; outline: none; }
        
        .login-btn { width: 320px; padding: 15px; background: #ff8c00; border: none; border-radius: 12px; color: #000; font-weight: bold; font-size: 18px; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .login-btn:active { transform: scale(0.98); background: #e67e00; }

        .error-msg { color: #ff4500; font-size: 14px; margin-bottom: 15px; height: 20px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header-area">
        <div class="logo-box">
            <span class="logo-icon">ğŸ’¬</span>
            <span class="logo-text">OLD MAFIA áƒ©áƒáƒ¢áƒ˜</span>
        </div>
    </div>

    <a href="inbox.html" class="inbox-link">ğŸ“© Inbox</a>

    <div id="status" class="error-msg"></div>
    
    <input type="text" id="user-nick" placeholder="áƒœáƒ˜áƒ™áƒ˜">
    <input type="password" id="user-pass" placeholder="áƒ›áƒ”áƒ¡áƒ˜áƒ¯áƒ˜ (áƒáƒœ áƒáƒáƒ áƒáƒšáƒ˜)">

    <button class="login-btn" onclick="handleLogin()">áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ</button>

<script>
    // áƒ¨áƒ”áƒœáƒ˜ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ—áƒ áƒ‘áƒáƒ–áƒ˜áƒ¡ áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ˜
    const _sb = supabase.createClient("https://ftfciebnywbondaiarnc.supabase.co", "sb_publishable_eQZDSu_Jy1gWmXJFF800Pw_TP2kBRLI");

    async function handleLogin() {
        const nick = document.getElementById('user-nick').value.trim();
        const status = document.getElementById('status');

        if (!nick) {
            status.innerText = "áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒœáƒ˜áƒ™áƒ˜!";
            return;
        }

        status.style.color = "#ff8c00";
        status.innerText = "áƒ•áƒ£áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ“áƒ”áƒ‘áƒ˜ áƒ›áƒáƒ¤áƒ˜áƒáƒ¡...";

        // áƒ•áƒáƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ— áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡ áƒ—áƒ£ áƒáƒ áƒ áƒ˜áƒ£áƒ–áƒ”áƒ áƒ˜ avatars_v3 áƒªáƒ®áƒ áƒ˜áƒšáƒ¨áƒ˜
        const { data: user, error } = await _sb.from('avatars_v3').select('*').eq('nickname', nick).single();

        if (user) {
            // áƒ—áƒ£ áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡ - áƒ¨áƒ”áƒ•áƒ“áƒ˜áƒ•áƒáƒ áƒ—
            localStorage.setItem('username', nick);
            location.href = 'home.html';
        } else {
            // áƒ—áƒ£ áƒáƒ  áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡ - áƒ•áƒáƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒ˜áƒ áƒ”áƒ‘áƒ—
            const { error: regErr } = await _sb.from('avatars_v3').insert([{ nickname: nick }]);
            if (regErr) {
                status.style.color = "#ff4500";
                status.innerText = "áƒ”áƒ¡ áƒœáƒ˜áƒ™áƒ˜ áƒ£áƒ™áƒ•áƒ” áƒ•áƒ˜áƒ¦áƒáƒªáƒáƒ› áƒ¬áƒáƒ’áƒáƒ áƒ—áƒ•áƒ!";
            } else {
                localStorage.setItem('username', nick);
                location.href = 'home.html';
            }
        }
    }
</script>

</body>
</html>
