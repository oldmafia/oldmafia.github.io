<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Old Mafia</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;font-family:Arial;background:#1a0000;color:white;overflow:hidden;}
.wrapper{display:flex;height:100%;}

.sidebar{
width:220px;
background:#2b0000;
padding:15px 10px;
display:flex;
flex-direction:column;
gap:10px;
overflow-y:auto;
transition:0.3s;
}

.room{
padding:12px;
border-radius:14px;
background:#3b0000;
cursor:pointer;
}

.room:hover{background:#550000;}
.room.active{background:#ff1a1a;}

.main{
flex:1;
display:flex;
flex-direction:column;
padding:15px;
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:10px;
}

.room-title{
color:#ff2e2e;
font-weight:bold;
}

.icon-btn,.menu-btn{
width:36px;
height:36px;
border:none;
border-radius:10px;
background:#3b0000;
color:white;
cursor:pointer;
}

.menu-btn{display:none;}

.chat-box{
flex:1;
background:#111;
border-radius:25px;
display:flex;
flex-direction:column;
overflow:hidden;
}

.chat{
flex:1;
padding:15px;
overflow-y:auto;
display:flex;
flex-direction:column;
}

.message{
background:#2a2a2a;
padding:12px 16px;
border-radius:20px;
margin-bottom:10px;
max-width:90%;
width:fit-content;
word-break:break-word;
}

.nickname{
color:#ff4d4d;
font-size:12px;
margin-bottom:4px;
}

.input-area{
display:flex;
gap:6px;
padding:10px;
background:#220000;
}

.input-area input{
flex:1;
height:38px;
border:none;
border-radius:14px;
background:#1e1e1e;
color:white;
padding:0 10px;
}

.send-btn{
width:85px;
height:38px;
border:none;
border-radius:14px;
background:#ff1a1a;
color:white;
font-weight:bold;
cursor:pointer;
}

.profile-box{
position:fixed;
top:50%;
left:50%;
transform:translate(-50%,-50%);
background:#111;
padding:20px;
border-radius:15px;
display:none;
z-index:2000;
}

@media (max-width:768px){
.sidebar{
position:fixed;
left:-220px;
top:0;
height:100%;
z-index:1500;
}
.sidebar.open{left:0;}
.menu-btn{display:block;}
.message{max-width:95%;}
}
</style>
</head>
<body>

<div class="wrapper">

<div class="sidebar" id="roomList"></div>

<div class="main">
<div class="topbar">
<button class="menu-btn" onclick="toggleMenu()">â˜°</button>
<div class="room-title" id="roomTitle">ğŸ’¬ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜</div>
<button class="icon-btn" onclick="openProfile()">ğŸ‘¤</button>
</div>

<div class="chat-box">
<div class="chat" id="chat"></div>
<div class="input-area">
<input type="text" id="msgInput" placeholder="áƒ“áƒáƒ¬áƒ”áƒ áƒ” áƒ›áƒ”áƒ¡áƒ˜áƒ¯áƒ˜...">
<button class="send-btn" onclick="sendMessage()">áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ</button>
</div>
</div>
</div>

</div>

<div class="profile-box" id="profileBox">
<h3>ğŸ‘¤ áƒáƒ áƒáƒ¤áƒ˜áƒšáƒ˜</h3>
<p>áƒ¡áƒáƒ®áƒ”áƒšáƒ˜: <span id="profileName"></span></p>
<p>ğŸ” áƒ¨áƒ˜áƒ¤áƒ áƒáƒ’áƒ áƒáƒ›áƒ: <span id="profileShifro"></span></p>
<br>
<button onclick="closeProfile()">áƒ“áƒáƒ®áƒ£áƒ áƒ•áƒ</button>
</div>

<script>

let nickname = localStorage.getItem("nickname") || "Guest";

let rooms = JSON.parse(localStorage.getItem("rooms")) || {
"ğŸ’¬ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜":[],
"ğŸ’ VIP áƒ¡áƒáƒ£áƒ‘áƒ áƒ”áƒ‘áƒ˜":[],
"ğŸ” áƒ¨áƒ˜áƒ¤áƒ áƒáƒ’áƒ áƒáƒ›áƒ":[],
"ğŸ§  áƒ•áƒ˜áƒ¥áƒ¢áƒáƒ áƒ˜áƒœáƒ":[],
"ğŸª¢ áƒ©áƒáƒ›áƒáƒ®áƒ áƒ©áƒáƒ‘áƒáƒœáƒ":[],
"ğŸ˜‚ áƒ˜áƒ£áƒ›áƒáƒ áƒ˜":[],
"ğŸµ áƒ›áƒ£áƒ¡áƒ˜áƒ™áƒ":[],
"ğŸ“¸ áƒ’áƒáƒšáƒ”áƒ áƒ”áƒ":[]
};

let userScores = JSON.parse(localStorage.getItem("scores")) || {};
if(!userScores[nickname]){
userScores[nickname]={shifrograma:0};
}

let currentRoom="ğŸ’¬ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜";
let gameActive=false;
let currentWord="";

const words=["áƒ™áƒáƒ¢áƒ","áƒ«áƒáƒ¦áƒšáƒ˜","áƒ›áƒ–áƒ”","áƒ›áƒ—áƒ•áƒáƒ áƒ”","áƒ¡áƒáƒ®áƒšáƒ˜","áƒ–áƒ¦áƒ•áƒ","áƒ¢áƒ§áƒ”","áƒ§áƒ•áƒáƒ•áƒ˜áƒšáƒ˜","áƒ¡áƒ™áƒáƒšáƒ","áƒ¥áƒáƒšáƒáƒ¥áƒ˜","áƒ‘áƒáƒ¦áƒ˜","áƒ¤áƒáƒœáƒ¯áƒáƒ áƒ","áƒ™áƒáƒ áƒ˜","áƒ›áƒáƒ’áƒ˜áƒ“áƒ","áƒ¡áƒ™áƒáƒ›áƒ˜"];

const correctSound=new Audio("https://www.soundjay.com/buttons/sounds/button-4.mp3");
const wrongSound=new Audio("https://www.soundjay.com/misc/sounds/fail-buzzer-02.mp3");

const roomList=document.getElementById("roomList");
const chat=document.getElementById("chat");
const roomTitle=document.getElementById("roomTitle");

function saveRooms(){
localStorage.setItem("rooms",JSON.stringify(rooms));
}

function renderRooms(){
roomList.innerHTML="";
Object.keys(rooms).forEach(room=>{
let div=document.createElement("div");
div.className="room";
if(room===currentRoom) div.classList.add("active");
div.innerText=room;
div.onclick=()=>changeRoom(room);
roomList.appendChild(div);
});
}

function changeRoom(room){
currentRoom=room;
roomTitle.innerText=room;
renderRooms();
renderMessages();
if(window.innerWidth<=768){
document.querySelector(".sidebar").classList.remove("open");
}
if(room==="ğŸ” áƒ¨áƒ˜áƒ¤áƒ áƒáƒ’áƒ áƒáƒ›áƒ" && !gameActive){
startGame();
}else{
gameActive=false;
}
}

function renderMessages(){
chat.innerHTML="";
rooms[currentRoom].forEach(msg=>{
let div=document.createElement("div");
div.className="message";
div.innerHTML="<div class='nickname'>"+msg.name+"</div>"+msg.text;
chat.appendChild(div);
});
chat.scrollTop=chat.scrollHeight;
}

function sendMessage(){
let input=document.getElementById("msgInput");
let text=input.value.trim();
if(!text) return;

rooms[currentRoom].push({name:nickname,text:text});
saveRooms();

if(currentRoom==="ğŸ” áƒ¨áƒ˜áƒ¤áƒ áƒáƒ’áƒ áƒáƒ›áƒ" && gameActive){
if(text===currentWord){
correctSound.play();
userScores[nickname].shifrograma+=10;
localStorage.setItem("scores",JSON.stringify(userScores));
rooms[currentRoom].push({name:"ğŸ¤– áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ",text:"âœ… áƒ¡áƒ¬áƒáƒ áƒ˜! +10 áƒ¥áƒ£áƒšáƒ | áƒ¡áƒ£áƒš: "+userScores[nickname].shifrograma});
saveRooms();
startGame();
}else{
wrongSound.play();
rooms[currentRoom].push({name:"ğŸ¤– áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ",text:"âŒ áƒáƒ áƒáƒ¡áƒ¬áƒáƒ áƒ˜áƒ"});
saveRooms();
}
}

input.value="";
renderMessages();
}

function shuffle(word){
return word.split('').sort(()=>Math.random()-0.5).join('');
}

function startGame(){
gameActive=true;
currentWord=words[Math.floor(Math.random()*words.length)];
rooms[currentRoom].push({name:"ğŸ¤– áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ",text:"ğŸ” áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ: "+shuffle(currentWord)});
saveRooms();
renderMessages();
}

function openProfile(){
document.getElementById("profileBox").style.display="block";
document.getElementById("profileName").innerText=nickname;
document.getElementById("profileShifro").innerText=userScores[nickname].shifrograma;
}

function closeProfile(){
document.getElementById("profileBox").style.display="none";
}

function toggleMenu(){
document.querySelector(".sidebar").classList.toggle("open");
}

renderRooms();
renderMessages();

</script>

</body>
</html>
