<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>áƒ›áƒáƒ¤áƒ˜áƒ áƒ©áƒáƒ¢áƒ˜</title>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(to bottom,#1a0000,#000);
color:white;
display:flex;
height:100vh;
}

.sidebar{
width:260px;
background:#140000;
padding:15px;
overflow-y:auto;
box-shadow:0 0 20px red;
}

.room{
background:#9b1111;
padding:12px;
border-radius:18px;
margin-bottom:10px;
cursor:pointer;
transition:0.2s;
}

.room:hover{
background:#ff2a2a;
}

.main{
flex:1;
display:flex;
flex-direction:column;
}

header{
display:flex;
justify-content:space-between;
align-items:center;
padding:15px;
background:#0d0d0d;
box-shadow:0 0 15px red;
}

.profile{
background:#1f1f1f;
padding:8px 15px;
border-radius:20px;
}

.messages{
flex:1;
overflow-y:auto;
padding:20px;
}

.message{
background:#2a2a2a;
padding:12px 15px;
border-radius:15px;
margin-bottom:10px;
max-width:70%;
}

.nickname{
color:#ff4d4d;
font-weight:bold;
font-size:13px;
margin-bottom:4px;
}

.input-bar{
display:flex;
padding:15px;
background:#111;
}

.input-bar input{
flex:1;
padding:12px;
border:none;
border-radius:20px;
background:#222;
color:white;
outline:none;
margin:0 8px;
}

.input-bar button{
padding:10px 15px;
border:none;
border-radius:15px;
background:red;
color:white;
cursor:pointer;
}

.emoji-btn{
background:#ff2a2a;
}
</style>
</head>
<body>

<div class="sidebar">
<div class="room" onclick="changeRoom('ğŸ”¥ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜')">ğŸ”¥ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜</div>
<div class="room" onclick="changeRoom('ğŸ” áƒ¨áƒ˜áƒ¤áƒ áƒáƒ’áƒ áƒáƒ›áƒ')">ğŸ” áƒ¨áƒ˜áƒ¤áƒ áƒáƒ’áƒ áƒáƒ›áƒ</div>
<div class="room" onclick="changeRoom('ğŸ§  áƒ•áƒ˜áƒ¥áƒ¢áƒáƒ áƒ˜áƒœáƒ')">ğŸ§  áƒ•áƒ˜áƒ¥áƒ¢áƒáƒ áƒ˜áƒœáƒ</div>
<div class="room" onclick="changeRoom('ğŸª¢ áƒ©áƒáƒ›áƒáƒ®áƒ áƒ©áƒáƒ‘áƒáƒœáƒ')">ğŸª¢ áƒ©áƒáƒ›áƒáƒ®áƒ áƒ©áƒáƒ‘áƒáƒœáƒ</div>
<div class="room" onclick="changeRoom('ğŸ—£ áƒ¤áƒáƒ áƒ£áƒ›áƒ˜')">ğŸ—£ áƒ¤áƒáƒ áƒ£áƒ›áƒ˜</div>
<div class="room" onclick="changeRoom('ğŸ”« áƒ˜áƒáƒ áƒáƒ¦áƒ˜áƒ¡ áƒáƒ—áƒáƒ®áƒ˜')">ğŸ”« áƒ˜áƒáƒ áƒáƒ¦áƒ˜áƒ¡ áƒáƒ—áƒáƒ®áƒ˜</div>
<div class="room" onclick="changeRoom('ğŸ’ áƒ•áƒ˜áƒ áƒ¡áƒáƒ£áƒ‘áƒ áƒ”áƒ‘áƒ˜')">ğŸ’ áƒ•áƒ˜áƒ áƒ¡áƒáƒ£áƒ‘áƒ áƒ”áƒ‘áƒ˜</div>
<div class="room" onclick="changeRoom('ğŸµ áƒ›áƒ£áƒ¡áƒ˜áƒ™áƒ')">ğŸµ áƒ›áƒ£áƒ¡áƒ˜áƒ™áƒ</div>
<div class="room" onclick="changeRoom('ğŸ“¸ áƒ’áƒáƒšáƒ”áƒ áƒ”áƒ')">ğŸ“¸ áƒ’áƒáƒšáƒ”áƒ áƒ”áƒ</div>
<div class="room" onclick="changeRoom('ğŸ˜‚ áƒ˜áƒ£áƒ›áƒáƒ áƒ˜')">ğŸ˜‚ áƒ˜áƒ£áƒ›áƒáƒ áƒ˜</div>
<div class="room" onclick="changeRoom('ğŸ†˜ áƒ“áƒáƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ')">ğŸ†˜ áƒ“áƒáƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ</div>
</div>

<div class="main">

<header>
<div id="roomTitle">ğŸ”¥ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜</div>
<div class="profile">
ğŸ‘¤ <span id="nickname">áƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...</span>
</div>
</header>

<div class="messages" id="messages"></div>

<div class="input-bar">
<button class="emoji-btn" onclick="addEmoji()">ğŸ˜Š</button>
<input type="text" id="messageInput" placeholder="áƒ“áƒáƒ¬áƒ”áƒ áƒ” áƒ¨áƒ”áƒ¢áƒ§áƒáƒ‘áƒ˜áƒœáƒ”áƒ‘áƒ...">
<button onclick="sendMessage()">áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ</button>
</div>

</div>

<script>
const { createClient } = supabase;

const supabaseClient = createClient(
"https://ftfciebnywbondaiarnc.supabase.co",
"sb_publishable_eQZDSu_Jy1gWmXJFF800Pw_TP2kBRLI"
);

let currentRoom="ğŸ”¥ áƒ–áƒáƒ’áƒáƒ“áƒ˜ áƒ©áƒáƒ¢áƒ˜";
let currentNickname="";

/* USER */
async function loadUser(){
const { data:{ user } } = await supabaseClient.auth.getUser();
if(!user){
window.location.href="index.html";
return;
}
currentNickname=user.user_metadata?.nickname || user.email;
document.getElementById("nickname").innerText=currentNickname;
}
loadUser();

/* ROOM CHANGE */
function changeRoom(room){
currentRoom=room;
document.getElementById("roomTitle").innerText=room;
loadMessages();
}

/* LOAD MESSAGES */
async function loadMessages(){
const { data } = await supabaseClient
.from("messages")
.select("*")
.eq("room",currentRoom)
.order("created_at",{ascending:true});

const container=document.getElementById("messages");
container.innerHTML="";

if(data){
data.forEach(msg=>{
const div=document.createElement("div");
div.className="message";
div.innerHTML=`<div class="nickname">${msg.nickname}</div>${msg.text}`;
container.appendChild(div);
});
}
}
loadMessages();

/* SEND MESSAGE */
async function sendMessage(){
const input=document.getElementById("messageInput");
const text=input.value.trim();
if(!text) return;

await supabaseClient.from("messages").insert([
{
room:currentRoom,
nickname:currentNickname,
text:text
}
]);

input.value="";
loadMessages();
}

/* EMOJI */
function addEmoji(){
const input=document.getElementById("messageInput");
input.value+=" ğŸ˜Š";
input.focus();
}
</script>

</body>
</html>
